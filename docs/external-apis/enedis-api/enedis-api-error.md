# Description des erreurs fréquentes Enedis

## API Authorize

| Code HTTP | Code                | Message                                  | Description et résolution                                                                                                                                                                                                                                                                                                  |
| --------- | ------------------- | ---------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 400       | invalid_request     | missing_parameter                        | Il manque des paramètres dans la requête. Consultez la documentation et complétez les champs requis.                                                                                                                                                                                                                       |
| 400       | invalid_request     | invalid_duration_format                  | La durée fournie doit respecter le format ISO 8601.                                                                                                                                                                                                                                                                        |
| 400       | invalid_request     | maximum_duration_exceeded                | La durée ne peut pas dépasser 3 ans et ne doit pas être négative.                                                                                                                                                                                                                                                          |
| 403       | access_denied       | access_denied                            | Le client a refusé d’accorder l’autorisation. Vérifiez le processus d’acceptation avec l’utilisateur.                                                                                                                                                                                                                      |
| 404       | Erreur 404          | La page que vous recherchez n’existe pas | Requête bloquée par les équipements de sécurité (URL incorrecte ou arguments non acceptés). Corrigez l’URL ou les paramètres envoyés.                                                                                                                                                                                      |
| 500       | server_error        | lincs-internal-server-error              | Erreur interne lors de la validation du consentement.<br>Utilisez uniquement des unités ISO 8601 en jours, semaines, mois ou années et vérifiez la compatibilité du navigateur (acceptation des cookies). Signalez l’incident au support avec le navigateur utilisé et l’horodatage de la requête si le problème persiste. |
| 503       | Service Unavailable | Service Unavailable                      | Le service est temporairement indisponible. Réitérez la requête après rétablissement du service.                                                                                                                                                                                                                           |

## API Token

| Code HTTP | Code            | Message                                                                                                                                                                                | Description et résolution                                                                                                                                                                |
| --------- | --------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 400       | invalid_request | missing_parameter                                                                                                                                                                      | Il manque des paramètres dans la requête. Vérifiez les champs obligatoires et complétez-les.                                                                                             |
| 400       | invalid_grant   | The provided authorization grant or refresh token is invalid, expired, revoked, does not match the redirection URI used in the authorization request, or was issued to another client. | Le code d’autorisation ou le jeton de rafraîchissement est invalide, expiré, déjà utilisé ou associé à une autre application. Relancez le parcours d’autorisation si nécessaire.         |
| 401       | Unauthorized    | Valid authentication credentials are mandatory to access the resource                                                                                                                  | Aucun code d’autorisation ou jeton de rafraîchissement valide n’a été trouvé. Si les paramètres sont corrects (code reçu < 3 min ou refresh token jamais utilisé), contactez le support. |

## API Metering et Customers

### Erreurs d’accès et de consentement

| Code HTTP | Code            | Message                                                         | Description et résolution                                                                                                                                                                     |
| --------- | --------------- | --------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 403       | ADAM-DC-0007    | The customer is not owner of this usage point.                  | Le client a déménagé, l’accès à ses données est impossible. Invitez-le à recommencer l’autorisation pour son nouveau point d’usage (PRM Linky requis).                                        |
| 403       | ADAM-DC-0008    | No consent can be found for this customer and this usage point. | Le consentement a été révoqué ou expiré. Informez le client et redemandez son accord s’il souhaite poursuivre.                                                                                |
| 500       | ADAM-DC-0500    | Technical Exception                                             | Erreur serveur temporaire lors du traitement de la requête. Réessayez plus tard. Après plusieurs échecs, contactez le support Data Connect avec la description et la requête concernée.       |
| 500       | STM-ERR-0000001 |                                                                 | Erreur serveur potentiellement temporaire ou liée à une faute de typographie. Réessayez plus tard et signaler au support Data Connect si le problème persiste avec les détails de la requête. |
| 404       | STM-ERR-0000019 | Unknown or unauthorized user.                                   | Aucun site de consommation/production associé au client. Vérifiez le numéro de point d’usage transmis, confirmez-le avec le client ou relancez une autorisation.                              |

### Paramètres `usage_point_id`

| Code HTTP | Code            | Message                                          | Description et résolution                                                                                                                                                  |
| --------- | --------------- | ------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 400       | Invalid_request | usage_point_id parameter is required.            | Le paramètre `usage_point_id` est obligatoire hors API d’autorisation. Corrigez le code et stockez ce paramètre (relancez l’autorisation si nécessaire pour le récupérer). |
| 400       | Invalid_request | usage_point_id parameter must be 14 digits long. | Le format attendu est une suite de 14 chiffres. Corrigez la valeur transmise ou redemandez l’autorisation pour récupérer la donnée correcte.                               |

### Quotas d’appels

| Code HTTP | Code             | Message                           | Description et résolution                                                                                                                                                                                 |
| --------- | ---------------- | --------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 429       | Quota Q3 reached | Call threshold allowed on X:XX:XX | Le quota de 5 appels par seconde est dépassé. Attendez le créneau indiqué avant de réessayer.                                                                                                             |
| 429       | Quota Q4 reached | Call threshold allowed on X:XX:XX | Le quota de 10 000 appels par heure est dépassé. Patientez avant de renvoyer des requêtes ; les données de comptage étant mises à jour une fois par jour, évitez les appels répétés dans la même journée. |

### Gestion des périodes et des dates

| Code HTTP | Code                        | Message                                                                        | Description et résolution                                                                                                                                                                                                                   |
| --------- | --------------------------- | ------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 403       | ADAM-DC-0009                | The start date of the request must be greater than the consent start date.     | La date de début demandée est antérieure à la date de consentement. Choisissez une date comprise dans la plage autorisée (cf. contrat ou guide utilisateur).                                                                                |
| 400       | ADAM-DC-0015                | The requested period must be less than 7 days for an access to the load curve. | La période demandée pour la courbe de charge dépasse 7 jours. Scindez la requête en intervalles plus courts (exemple dans le guide utilisateur).                                                                                            |
| 400       | ADAM-DC-0016 / ADAM-ERR0125 | The start date must be greater than the history deadline.                      | La date `start` ne peut pas dépasser l’horizon historique : J-24 mois et 16 jours pour la courbe de charge, J-36 mois et 16 jours pour la consommation quotidienne ou la puissance maximale. Choisissez une date valide selon la ressource. |
| 400       | invalid_request             | Start date parameter is required.                                              | Le paramètre `start` est absent. Ajoutez-le comme décrit dans la documentation (exemples de code disponibles).                                                                                                                              |
| 400       | invalid_request             | start date parameter must be in the format yyyy-mm-dd.                         | Le paramètre `start` doit respecter le format RFC 3339 (date). Corrigez la mise en forme.                                                                                                                                                   |
| 400       | invalid_resquest            | end date parameter must be in the format yyyy-mm-dd.                           | Le paramètre `end` doit respecter le format RFC 3339 (date). Corrigez la mise en forme.                                                                                                                                                     |
| 400       | invalid_request             | End date parameter is required.                                                | Le paramètre `end` est absent. Ajoutez-le conformément aux exemples fournis.                                                                                                                                                                |
| 400       | invalid_request             | The end date parameter must be earlier than the current date.                  | `end` ne peut pas être dans le futur (données disponibles à J-1). Utilisez la veille comme date maximale.                                                                                                                                   |
| 400       | invalid_request             | Start date should be before end date.                                          | La date de début est postérieure à la date de fin. Requêtez avec un `start` antérieur à `end`.                                                                                                                                              |

### Cas particuliers Linky et données

| Code HTTP | Code            | Message                                                     | Description et résolution                                                                                                                                                                                                                       |
| --------- | --------------- | ----------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 400       | ADAM-ERR0069    | Le sens de la mesure ne correspond pas pour le PRM demandé. | Vous interrogez une donnée de consommation sur un PRM de production, ou l’inverse. La même requête renverra toujours cette erreur. Vérifiez le type de PRM ciblé.                                                                               |
| 404       | STM-ERR-0000014 |                                                             | Aucune donnée disponible pour le client (pas de compteur communicant, trou de données, courbe de charge inactive). Vérifiez le statut `usage_point-status`, élargissez la période demandée ou demandez au client d’activer sa courbe de charge. |
| 404       | STM-ERR-0000020 | no measure found for this usage point                       | Aucune mesure trouvée pour le point d’usage. Contrôlez la période interrogée et la disponibilité des données.                                                                                                                                   |
| 404       | no_data_found   | no measure found for this usage point                       | Variante du message précédent : aucune donnée retournée pour ce point d’usage. Vérifiez le PRM, la période et la disponibilité des mesures.                                                                                                     |
