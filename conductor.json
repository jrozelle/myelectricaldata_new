{
  "name": "myelectricaldata-dev",
  "description": "Environnement de développement Docker Compose avec ports dynamiques",
  "onStart": {
    "command": "./scripts/conductor-start.sh",
    "description": "Démarre les services frontend et backend avec ports libres",
    "waitForReady": true,
    "timeout": 180
  },
  "onStop": {
    "command": "./scripts/conductor-stop.sh",
    "description": "Arrête les services Docker Compose"
  },
  "services": {
    "frontend": {
      "type": "docker-compose",
      "service": "frontend",
      "portVariable": "FRONTEND_PORT",
      "defaultPort": 8000,
      "healthCheck": "http://localhost:${FRONTEND_PORT}"
    },
    "backend": {
      "type": "docker-compose",
      "service": "backend",
      "portVariable": "BACKEND_PORT",
      "defaultPort": 8081,
      "healthCheck": "http://localhost:${BACKEND_PORT}/ping"
    }
  },
  "infrastructure": {
    "redis": {
      "type": "external",
      "envFile": ".env.local",
      "envVariable": "REDIS_URL",
      "default": "redis://localhost:6379/0"
    },
    "postgres": {
      "type": "external",
      "envFile": ".env.local",
      "envVariable": "DATABASE_URL",
      "default": "postgresql+asyncpg://myelectricaldata:mySecurePassword2025@localhost:5432/myelectricaldata"
    }
  },
  "scripts": {
    "start": {
      "command": "./scripts/conductor-start.sh",
      "description": "Démarre les services frontend et backend"
    },
    "stop": {
      "command": "./scripts/conductor-stop.sh",
      "description": "Arrête les services Docker Compose"
    },
    "logs": {
      "command": "docker compose logs -f frontend backend",
      "description": "Affiche les logs des services"
    },
    "logs:backend": {
      "command": "docker compose logs -f backend",
      "description": "Affiche les logs du backend"
    },
    "logs:frontend": {
      "command": "docker compose logs -f frontend",
      "description": "Affiche les logs du frontend"
    },
    "restart": {
      "command": "docker compose restart frontend backend",
      "description": "Redémarre les services"
    },
    "status": {
      "command": "docker compose ps",
      "description": "Affiche le statut des services"
    }
  },
  "env": {
    "COMPOSE_PROJECT_NAME": "med-${CONDUCTOR_BRANCH_SLUG}",
    "CONDUCTOR_BRANCH_SLUG": "${CONDUCTOR_BRANCH_SLUG:-dev}"
  }
}
